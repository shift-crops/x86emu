#include "common.h"

extern void _putc(char);

void print_key(uint8_t scancode){
	static bool shift = false;
	uint8_t buf[2] = {0};
	static uint8_t keytable_n[0x7f] = {
		0x0, 0x0, '1', '2', '3', '4', '5', '6', '7', '8', '9', '0', '-', '^', 0x0, 0,
		'q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p', '@', '[', 0xa, 0x0, 'a', 's',
		'd', 'f', 'g', 'h', 'j', 'k', 'l', ';', ':', ' ', 0x0, ']', 'z', 'x', 'c', 'v',
		'b', 'n', 'm', ',', '.', '/', 0x0, '*', 0x0, ' ', 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
		0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, '7', '8', '9', '-', '4', '5', '6', '+', '1',
		'2', '3', '0', '.', 0x0, 0x0, 0x0, 0x0, 0x0, '\\', 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
	};
	static uint8_t keytable_s[0x7f] = {
		0x0, 0x0, '!', '"', '#', '$', '%', '&', '\'', '(', ')', '~', '=', '~', 0x0, 0,
		'Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P', '`', '{', 0xa, 0x0, 'A', 'S',
		'D', 'F', 'G', 'H', 'J', 'K', 'L', '+', '*', ' ', 0x0, '}', 'Z', 'X', 'C', 'V',
		'B', 'N', 'M', '<', '>', '?', 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
		0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
		0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, '_', 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
	};


	switch(scancode){
		case 0x2a:
		case 0x36:
			shift = true;
			break;
		case 0xaa:
		case 0xb6:
			shift = false;
			break;
		default:
			if(!(scancode&0x80))
				_putc(shift ? keytable_s[scancode] : keytable_n[scancode]);
	}
}
